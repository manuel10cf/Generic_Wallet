var blocktrail = require('./main');

var client = blocktrail.BlocktrailSDK({
    apiKey : process.env.BLOCKTRAIL_SDK_APIKEY,
    apiSecret : process.env.BLOCKTRAIL_SDK_APISECRET,
    testnet : true
});

var passphrase = 'alakvnjaksdfjakskbfasdhjfbasdfalsdfkasjbdfmnabasdufiuwebfasafndmbaxcnasxlabgfngbdsbgksfjgb';

client.initWallet({
    identifier: "test-v3-testdeferred1",
    passphrase: passphrase
})
    .then(function(wallet) {
        wallet
            .getInfo()
            .then(function(result) {
                var confirmed = result[0],
                    unconfirmed = result[1];
                console.log('confirmed balance', confirmed);
                console.log('unconfirmed balance', unconfirmed);
            }, function (err) {
                return console.log("getBalance ERR", err);
            });

        wallet
            .getNewAddress()
            .then(function(address) {

                console.log('address', address);
                wallet.unlock({passphrase: passphrase}, function() {
                    console.log('db', address);
                });
                //    sendTransaction(wallet);
                //}, function (err) {
                //    return console.log("unlock ERR", err);
                //});
            }, function (err) {
                return console.log("getNewAddress ERR", err);
            });
    }, function (err) {
        console.log('initWallet ERR', err);
        throw err;
    }, function (note) {
      console.log(note);
    });